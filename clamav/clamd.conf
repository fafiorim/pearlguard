# ClamAV Daemon Configuration
# Custom configuration for PearlGuard

# Logging
LogFile /var/log/clamav/clamd.log
LogTime yes
LogClean yes
LogVerbose yes
LogFileMaxSize 10M
LogRotate yes
ExtendedDetectionInfo yes
# Note: Generate JSON metadata for scans
OfficialDatabaseOnly no

# Socket configuration
LocalSocket /tmp/clamd.sock
TCPSocket 3310
FixStaleSocket yes

# Database
DatabaseDirectory /var/lib/clamav

# Scanning options
MaxThreads 10
ReadTimeout 120
MaxDirectoryRecursion 15
FollowDirectorySymlinks no
FollowFileSymlinks no
CrossFilesystems yes
SelfCheck 600

# Detection options
ScanPE yes
ScanELF yes
ScanMail yes
ScanOLE2 yes
ScanPDF yes
ScanSWF yes
ScanHTML yes
ScanXMLDOCS yes

# Heuristics
HeuristicAlerts yes
Bytecode yes

# Phishing detection
PhishingSignatures yes
PhishingScanURLs yes

# Archive scanning
ScanArchive yes
AlertBrokenExecutables yes

# Detection of potentially unwanted applications
# DetectPUA yes  # Uncomment to enable PUA detection

# Alert on specific content
# AlertOLE2Macros yes  # Uncomment to alert on Office macros
# AlertEncrypted yes  # Uncomment to alert on encrypted files
# AlertEncryptedArchive yes  # Uncomment to alert on encrypted archives
# AlertEncryptedDoc yes  # Uncomment to alert on encrypted documents

# Structured data detection (SSN, Credit Cards)
# StructuredDataDetection yes  # Uncomment to enable
# StructuredMinCreditCardCount 3
# StructuredMinSSNCount 3

# Performance
ConcurrentDatabaseReload yes
